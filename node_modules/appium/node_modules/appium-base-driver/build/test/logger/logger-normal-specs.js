require('source-map-support').install();

'use strict';

var _helpers = require('./helpers');

describe('normal logger', function () {
  var writers = undefined,
      log = undefined;
  beforeEach(function () {
    writers = (0, _helpers.setupWriters)();
    log = (0, _helpers.getDynamicLogger)(false, false);
    log.level = 'silly';
  });

  afterEach(function () {
    (0, _helpers.restoreWriters)(writers);
  });

  it('should not rewrite log levels outside of testing', function () {
    log.silly('silly');
    (0, _helpers.assertOutputContains)(writers, 'silly');
    log.verbose('verbose');
    (0, _helpers.assertOutputContains)(writers, 'verbose');
    log.verbose('debug');
    (0, _helpers.assertOutputContains)(writers, 'debug');
    log.info('info');
    (0, _helpers.assertOutputContains)(writers, 'info');
    log.http('http');
    (0, _helpers.assertOutputContains)(writers, 'http');
    log.warn('warn');
    (0, _helpers.assertOutputContains)(writers, 'warn');
    log.error('error');
    (0, _helpers.assertOutputContains)(writers, 'error');
  });
  it('throw should not rewrite log levels outside of testing and throw error', function () {
    (function () {
      log.errorAndThrow('msg1');
    }).should['throw']('msg1');
    (function () {
      log.errorAndThrow(new Error('msg2'));
    }).should['throw']('msg2');
    (0, _helpers.assertOutputContains)(writers, 'msg1');
    (0, _helpers.assertOutputContains)(writers, 'msg2');
  });
  it('should get and set log levels', function () {
    log.level = 'warn';
    log.level.should.equal('warn');
    log.info('information');
    log.warn('warning');
    (0, _helpers.assertOutputDoesntContain)(writers, 'information');
    (0, _helpers.assertOutputContains)(writers, 'warning');
  });
});

describe('normal logger with prefix', function () {
  var writers = undefined,
      log = undefined;
  before(function () {
    writers = (0, _helpers.setupWriters)();
    log = (0, _helpers.getDynamicLogger)(false, false, 'myprefix');
    log.level = 'silly';
  });

  after(function () {
    (0, _helpers.restoreWriters)(writers);
  });

  it('should not rewrite log levels outside of testing', function () {
    log.silly('silly');
    (0, _helpers.assertOutputContains)(writers, 'silly');
    (0, _helpers.assertOutputContains)(writers, 'myprefix');
    log.verbose('verbose');
    (0, _helpers.assertOutputContains)(writers, 'verbose');
    (0, _helpers.assertOutputContains)(writers, 'myprefix');
    log.verbose('debug');
    (0, _helpers.assertOutputContains)(writers, 'debug');
    (0, _helpers.assertOutputContains)(writers, 'myprefix');
    log.info('info');
    (0, _helpers.assertOutputContains)(writers, 'info');
    (0, _helpers.assertOutputContains)(writers, 'myprefix');
    log.http('http');
    (0, _helpers.assertOutputContains)(writers, 'http');
    (0, _helpers.assertOutputContains)(writers, 'myprefix');
    log.warn('warn');
    (0, _helpers.assertOutputContains)(writers, 'warn');
    (0, _helpers.assertOutputContains)(writers, 'myprefix');
    log.error('error');
    (0, _helpers.assertOutputContains)(writers, 'error');
    (0, _helpers.assertOutputContains)(writers, 'myprefix');
  });
  it('throw should not rewrite log levels outside of testing and throw error', function () {
    (function () {
      log.errorAndThrow('msg');
    }).should['throw']('msg');
    (0, _helpers.assertOutputContains)(writers, 'error');
    (0, _helpers.assertOutputContains)(writers, 'myprefix');
  });
});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRlc3QvbG9nZ2VyL2xvZ2dlci1ub3JtYWwtc3BlY3MuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozt1QkFHZ0UsV0FBVzs7QUFFM0UsUUFBUSxDQUFDLGVBQWUsRUFBRSxZQUFNO0FBQzlCLE1BQUksT0FBTyxZQUFBO01BQUUsR0FBRyxZQUFBLENBQUM7QUFDakIsWUFBVSxDQUFDLFlBQU07QUFDZixXQUFPLEdBQUcsNEJBQWMsQ0FBQztBQUN6QixPQUFHLEdBQUcsK0JBQWlCLEtBQUssRUFBRSxLQUFLLENBQUMsQ0FBQztBQUNyQyxPQUFHLENBQUMsS0FBSyxHQUFHLE9BQU8sQ0FBQztHQUNyQixDQUFDLENBQUM7O0FBRUgsV0FBUyxDQUFDLFlBQU07QUFDZCxpQ0FBZSxPQUFPLENBQUMsQ0FBQztHQUN6QixDQUFDLENBQUM7O0FBRUgsSUFBRSxDQUFDLGtEQUFrRCxFQUFFLFlBQU07QUFDM0QsT0FBRyxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQztBQUNuQix1Q0FBcUIsT0FBTyxFQUFFLE9BQU8sQ0FBQyxDQUFDO0FBQ3ZDLE9BQUcsQ0FBQyxPQUFPLENBQUMsU0FBUyxDQUFDLENBQUM7QUFDdkIsdUNBQXFCLE9BQU8sRUFBRSxTQUFTLENBQUMsQ0FBQztBQUN6QyxPQUFHLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxDQUFDO0FBQ3JCLHVDQUFxQixPQUFPLEVBQUUsT0FBTyxDQUFDLENBQUM7QUFDdkMsT0FBRyxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQztBQUNqQix1Q0FBcUIsT0FBTyxFQUFFLE1BQU0sQ0FBQyxDQUFDO0FBQ3RDLE9BQUcsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUM7QUFDakIsdUNBQXFCLE9BQU8sRUFBRSxNQUFNLENBQUMsQ0FBQztBQUN0QyxPQUFHLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDO0FBQ2pCLHVDQUFxQixPQUFPLEVBQUUsTUFBTSxDQUFDLENBQUM7QUFDdEMsT0FB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Q0FBQyxPQUFPLENBQUMsQ0FBQztBQUNuQix1Q0FBcUIsT0FBTyxFQUFFLE9BQU8sQ0FBQyxDQUFDO0FBQ3ZDLHVDQUFxQixPQUFPLEVBQUUsVUFBVSxDQUFDLENBQUM7R0FDM0MsQ0FBQyxDQUFDO0FBQ0gsSUFBRSxDQUFDLHdFQUF3RSxFQUFFLFlBQU07QUFDakYsS0FBQyxZQUFNO0FBQUUsU0FBRyxDQUFDLGFBQWEsQ0FBQyxLQUFLLENBQUMsQ0FBQztLQUFFLENBQUEsQ0FBRSxNQUFNLFNBQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQztBQUMxRCx1Q0FBcUIsT0FBTyxFQUFFLE9BQU8sQ0FBQyxDQUFDO0FBQ3ZDLHVDQUFxQixPQUFPLEVBQUUsVUFBVSxDQUFDLENBQUM7R0FDM0MsQ0FBQyxDQUFDO0NBQ0osQ0FBQyxDQUFDIiwiZmlsZSI6InRlc3QvbG9nZ2VyL2xvZ2dlci1ub3JtYWwtc3BlY3MuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyB0cmFuc3BpbGU6bW9jaGFcblxuaW1wb3J0IHsgZ2V0RHluYW1pY0xvZ2dlciwgcmVzdG9yZVdyaXRlcnMsIHNldHVwV3JpdGVycyxcbiAgICAgICAgIGFzc2VydE91dHB1dENvbnRhaW5zLCBhc3NlcnRPdXRwdXREb2VzbnRDb250YWluIH0gZnJvbSAnLi9oZWxwZXJzJztcblxuZGVzY3JpYmUoJ25vcm1hbCBsb2dnZXInLCAoKSA9PiB7XG4gIGxldCB3cml0ZXJzLCBsb2c7XG4gIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgIHdyaXRlcnMgPSBzZXR1cFdyaXRlcnMoKTtcbiAgICBsb2cgPSBnZXREeW5hbWljTG9nZ2VyKGZhbHNlLCBmYWxzZSk7XG4gICAgbG9nLmxldmVsID0gJ3NpbGx5JztcbiAgfSk7XG5cbiAgYWZ0ZXJFYWNoKCgpID0+IHtcbiAgICByZXN0b3JlV3JpdGVycyh3cml0ZXJzKTtcbiAgfSk7XG5cbiAgaXQoJ3Nob3VsZCBub3QgcmV3cml0ZSBsb2cgbGV2ZWxzIG91dHNpZGUgb2YgdGVzdGluZycsICgpID0+IHtcbiAgICBsb2cuc2lsbHkoJ3NpbGx5Jyk7XG4gICAgYXNzZXJ0T3V0cHV0Q29udGFpbnMod3JpdGVycywgJ3NpbGx5Jyk7XG4gICAgbG9nLnZlcmJvc2UoJ3ZlcmJvc2UnKTtcbiAgICBhc3NlcnRPdXRwdXRDb250YWlucyh3cml0ZXJzLCAndmVyYm9zZScpO1xuICAgIGxvZy52ZXJib3NlKCdkZWJ1ZycpO1xuICAgIGFzc2VydE91dHB1dENvbnRhaW5zKHdyaXRlcnMsICdkZWJ1ZycpO1xuICAgIGxvZy5pbmZvKCdpbmZvJyk7XG4gICAgYXNzZXJ0T3V0cHV0Q29udGFpbnMod3JpdGVycywgJ2luZm8nKTtcbiAgICBsb2cuaHR0cCgnaHR0cCcpO1xuICAgIGFzc2VydE91dHB1dENvbnRhaW5zKHdyaXRlcnMsICdodHRwJyk7XG4gICAgbG9nLndhcm4oJ3dhcm4nKTtcbiAgICBhc3NlcnRPdXRwdXRDb250YWlucyh3cml0ZXJzLCAnd2FybicpO1xuICAgIGxvZy5lcnJvcignZXJyb3InKTtcbiAgICBhc3NlcnRPdXRwdXRDb250YWlucyh3cml0ZXJzLCAnZXJyb3InKTtcbiAgfSk7XG4gIGl0KCd0aHJvdyBzaG91bGQgbm90IHJld3JpdGUgbG9nIGxldmVscyBvdXRzaWRlIG9mIHRlc3RpbmcgYW5kIHRocm93IGVycm9yJywgKCkgPT4ge1xuICAgICgoKSA9PiB7IGxvZy5lcnJvckFuZFRocm93KCdtc2cxJyk7IH0pLnNob3VsZC50aHJvdygnbXNnMScpO1xuICAgICgoKSA9PiB7IGxvZy5lcnJvckFuZFRocm93KG5ldyBFcnJvcignbXNnMicpKTsgfSkuc2hvdWxkLnRocm93KCdtc2cyJyk7XG4gICAgYXNzZXJ0T3V0cHV0Q29udGFpbnMod3JpdGVycywgJ21zZzEnKTtcbiAgICBhc3NlcnRPdXRwdXRDb250YWlucyh3cml0ZXJzLCAnbXNnMicpO1xuICB9KTtcbiAgaXQoJ3Nob3VsZCBnZXQgYW5kIHNldCBsb2cgbGV2ZWxzJywgKCkgPT4ge1xuICAgIGxvZy5sZXZlbCA9ICd3YXJuJztcbiAgICBsb2cubGV2ZWwuc2hvdWxkLmVxdWFsKCd3YXJuJyk7XG4gICAgbG9nLmluZm8oJ2luZm9ybWF0aW9uJyk7XG4gICAgbG9nLndhcm4oJ3dhcm5pbmcnKTtcbiAgICBhc3NlcnRPdXRwdXREb2VzbnRDb250YWluKHdyaXRlcnMsICdpbmZvcm1hdGlvbicpO1xuICAgIGFzc2VydE91dHB1dENvbnRhaW5zKHdyaXRlcnMsICd3YXJuaW5nJyk7XG4gIH0pO1xufSk7XG5cbmRlc2NyaWJlKCdub3JtYWwgbG9nZ2VyIHdpdGggcHJlZml4JywgKCkgPT4ge1xuICBsZXQgd3JpdGVycywgbG9nO1xuICBiZWZvcmUoKCkgPT4ge1xuICAgIHdyaXRlcnMgPSBzZXR1cFdyaXRlcnMoKTtcbiAgICBsb2cgPSBnZXREeW5hbWljTG9nZ2VyKGZhbHNlLCBmYWxzZSwgJ215cHJlZml4Jyk7XG4gICAgbG9nLmxldmVsID0gJ3NpbGx5JztcbiAgfSk7XG5cbiAgYWZ0ZXIoKCkgPT4ge1xuICAgIHJlc3RvcmVXcml0ZXJzKHdyaXRlcnMpO1xuICB9KTtcblxuICBpdCgnc2hvdWxkIG5vdCByZXdyaXRlIGxvZyBsZXZlbHMgb3V0c2lkZSBvZiB0ZXN0aW5nJywgKCkgPT4ge1xuICAgIGxvZy5zaWxseSgnc2lsbHknKTtcbiAgICBhc3NlcnRPdXRwdXRDb250YWlucyh3cml0ZXJzLCAnc2lsbHknKTtcbiAgICBhc3NlcnRPdXRwdXRDb250YWlucyh3cml0ZXJzLCAnbXlwcmVmaXgnKTtcbiAgICBsb2cudmVyYm9zZSgndmVyYm9zZScpO1xuICAgIGFzc2VydE91dHB1dENvbnRhaW5zKHdyaXRlcnMsICd2ZXJib3NlJyk7XG4gICAgYXNzZXJ0T3V0cHV0Q29udGFpbnMod3JpdGVycywgJ215cHJlZml4Jyk7XG4gICAgbG9nLnZlcmJvc2UoJ2RlYnVnJyk7XG4gICAgYXNzZXJ0T3V0cHV0Q29udGFpbnMod3JpdGVycywgJ2RlYnVnJyk7XG4gICAgYXNzZXJ0T3V0cHV0Q29udGFpbnMod3JpdGVycywgJ215cHJlZml4Jyk7XG4gICAgbG9nLmluZm8oJ2luZm8nKTtcbiAgICBhc3NlcnRPdXRwdXRDb250YWlucyh3cml0ZXJzLCAnaW5mbycpO1xuICAgIGFzc2VydE91dHB1dENvbnRhaW5zKHdyaXRlcnMsICdteXByZWZpeCcpO1xuICAgIGxvZy5odHRwKCdodHRwJyk7XG4gICAgYXNzZXJ0T3V0cHV0Q29udGFpbnMod3JpdGVycywgJ2h0dHAnKTtcbiAgICBhc3NlcnRPdXRwdXRDb250YWlucyh3cml0ZXJzLCAnbXlwcmVmaXgnKTtcbiAgICBsb2cud2Fybignd2FybicpO1xuICAgIGFzc2VydE91dHB1dENvbnRhaW5zKHdyaXRlcnMsICd3YXJuJyk7XG4gICAgYXNzZXJ0T3V0cHV0Q29udGFpbnMod3JpdGVycywgJ215cHJlZml4Jyk7XG4gICAgbG9nLmVycm9yKCdlcnJvcicpO1xuICAgIGFzc2VydE91dHB1dENvbnRhaW5zKHdyaXRlcnMsICdlcnJvcicpO1xuICAgIGFzc2VydE91dHB1dENvbnRhaW5zKHdyaXRlcnMsICdteXByZWZpeCcpO1xuICB9KTtcbiAgaXQoJ3Rocm93IHNob3VsZCBub3QgcmV3cml0ZSBsb2cgbGV2ZWxzIG91dHNpZGUgb2YgdGVzdGluZyBhbmQgdGhyb3cgZXJyb3InLCAoKSA9PiB7XG4gICAgKCgpID0+IHsgbG9nLmVycm9yQW5kVGhyb3coJ21zZycpOyB9KS5zaG91bGQudGhyb3coJ21zZycpO1xuICAgIGFzc2VydE91dHB1dENvbnRhaW5zKHdyaXRlcnMsICdlcnJvcicpO1xuICAgIGFzc2VydE91dHB1dENvbnRhaW5zKHdyaXRlcnMsICdteXByZWZpeCcpO1xuICB9KTtcbn0pO1xuIl0sInNvdXJjZVJvb3QiOiIuLi8uLi8uLiJ9
